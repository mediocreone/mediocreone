<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="RITSEC CTF 2021 notes" /><meta name="author" content="mediocre_one" /><meta property="og:locale" content="en_US" /><meta name="description" content="RITSEC CTF 2021 notes" /><meta property="og:description" content="RITSEC CTF 2021 notes" /><link rel="canonical" href="mediocreone.com/2021/04/12/ritsec-ctf-2021" /><meta property="og:url" content="mediocreone.com/2021/04/12/ritsec-ctf-2021" /><meta property="og:site_name" content="Just a blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-04-12T00:00:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="RITSEC CTF 2021 notes" /><meta name="twitter:site" content="@mediocre_one" /><meta name="twitter:creator" content="@mediocre_one" /> <script type="application/ld+json"> {"description":"RITSEC CTF 2021 notes","@type":"BlogPosting","url":"mediocreone.com/2021/04/12/ritsec-ctf-2021","headline":"RITSEC CTF 2021 notes","dateModified":"2021-04-12T00:00:00+00:00","datePublished":"2021-04-12T00:00:00+00:00","mainEntityOfPage":{"@type":"WebPage","@id":"mediocreone.com/2021/04/12/ritsec-ctf-2021"},"author":{"@type":"Person","name":"mediocre_one"},"@context":"https://schema.org"}</script><title> RITSEC CTF 2021 notes - Just a blog</title><link rel="shortcut icon" href="/favicon.png"><link rel="alternate" type="application/atom+xml" title="Just a blog" href="/atom.xml"><link rel="alternate" type="application/json" title="Just a blog" href="mediocreone.com/feed.json" /><link rel="sitemap" type="application/xml" title="sitemap" href="/sitemap.xml" /><style> .highlight .hll{background-color:#ffffcc}.highlight .c{color:#808080}.highlight .err{color:#F00000;background-color:#F0A0A0}.highlight .k{color:#008000;font-weight:bold}.highlight .o{color:#303030}.highlight .cm{color:#808080}.highlight .cp{color:#507090}.highlight .c1{color:#808080}.highlight .cs{color:#cc0000;font-weight:bold}.highlight .gd{color:#A00000}.highlight .ge{font-style:italic}.highlight .gr{color:#FF0000}.highlight .gh{color:#000080;font-weight:bold}.highlight .gi{color:#00A000}.highlight .go{color:#808080}.highlight .gp{color:#c65d09;font-weight:bold}.highlight .gs{font-weight:bold}.highlight .gu{color:#800080;font-weight:bold}.highlight .gt{color:#0040D0}.highlight .kc,.highlight .kd,.highlight .kn{color:#008000;font-weight:bold}.highlight .kp{color:#003080;font-weight:bold}.highlight .kr{color:#008000;font-weight:bold}.highlight .kt{color:#303090;font-weight:bold}.highlight .m{color:#6000E0;font-weight:bold}.highlight .s{background-color:#fff0f0}.highlight .na{color:#0000C0}.highlight .nb{color:#007020}.highlight .nc{color:#B00060;font-weight:bold}.highlight .no{color:#003060;font-weight:bold}.highlight .nd{color:#505050;font-weight:bold}.highlight .ni{color:#800000;font-weight:bold}.highlight .ne{color:#F00000;font-weight:bold}.highlight .nf{color:#0060B0;font-weight:bold}.highlight .nl{color:#907000;font-weight:bold}.highlight .nn{color:#0e84b5;font-weight:bold}.highlight .nt{color:#007000}.highlight .nv{color:#906030}.highlight .ow{color:#000000;font-weight:bold}.highlight .w{color:#bbbbbb}.highlight .mf{color:#6000E0;font-weight:bold}.highlight .mh{color:#005080;font-weight:bold}.highlight .mi{color:#0000D0;font-weight:bold}.highlight .mo{color:#4000E0;font-weight:bold}.highlight .sb{background-color:#fff0f0}.highlight .sc{color:#0040D0}.highlight .sd{color:#D04020}.highlight .s2{background-color:#fff0f0}.highlight .se{color:#606060;font-weight:bold;background-color:#fff0f0}.highlight .sh{background-color:#fff0f0}.highlight .si{background-color:#e0e0e0}.highlight .sx{color:#D02000;background-color:#fff0f0}.highlight .sr{color:#000000;background-color:#fff0ff}.highlight .s1{background-color:#fff0f0}.highlight .ss{color:#A06000}.highlight .bp{color:#007020}.highlight .vc{color:#306090}.highlight .vg{color:#d07000;font-weight:bold}.highlight .vi{color:#3030B0}.highlight .il{color:#0000D0;font-weight:bold}*,:after,:before{box-sizing:border-box;background-color:inherit;color:inherit;margin:0;padding:0}body{font-family:system-ui, sans-serif;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;line-height:1.5;font-size:1rem;color:#16171a}nav ul{border-right:1px solid #edf2f7}a{color:#000;text-decoration-skip-ink:auto;text-decoration:underline}pre{margin:0.5rem 0;padding:0.5rem}.post p{margin:0.5rem 0}.post h1,.post h2,.post h3,.post h4{margin:1rem 0}.post h2:first-child,.project h2:first-child,.photo h2:first-child{margin-top:0}.meta{margin:2rem 0}code,pre{background:#ecedee}code{padding:0.1rem}pre code{border:none}pre{padding:1rem;overflow-x:auto}img{max-width:100%}hr{background:#000;height:1px;border:0}header{flex-basis:10rem;flex-grow:1;position:relative}header a{text-decoration:none}header li{margin-bottom:0.2rem;text-align:right;margin-right:2rem}header a.active{font-weight:bold}header,section{padding:1rem}blockquote{font-style:italic;border-left:5px solid #ececec;padding-left:1rem}h1,h2,h3,h4,h5{line-height:1;margin:1rem 0;font-weight:600}section h1:first-child{margin-top:0}strong,b{font-weight:bold}.photos ul{list-style:none}.photos li{margin-bottom:1.5rem}.photo picture,.project picture{margin-bottom:0.5rem}.posts ul,header ul{list-style:none}.posts li{align-items:center;display:flex;justify-content:space-between;margin-bottom:0.5rem}.posts li a,.posts li div,.projects li a{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-decoration:none}.posts li time,.projects li time{padding-left:1rem;white-space:nowrap;font-variant-numeric:tabular-nums}main{display:flex;flex-wrap:wrap;max-width:75rem;margin:2rem auto;padding:1rem}@media screen and (max-width: 45rem){header li{display:inline;margin-right:1rem}.logo{padding-bottom:1rem}header ul{border-bottom:1px solid #edf2f7;padding-bottom:2rem}nav ul{border-right:0px}.photos ul{margin-top:0.5rem}}section{flex-basis:0;flex-grow:999;min-width:70%;display:flex;flex-direction:column}figcaption{font-size:smaller}.right1,.networth dd span,.networth .total span,.networth .total small,.networth .expiration .note{float:right;margin-right:1em}.networth{margin-top:40px;border-right:1px solid #edf2f7}.networth dt,.networth .date{text-align:right;margin-right:2rem}.networth .total{margin-top:20px;padding-bottom:20px}.expiration{margin-top:30px}.coffee{position:fixed;bottom:18px}.language-nasm .highlight .err{color:inherit;background-color:inherit}.language-bash .highlight .err{color:inherit;background-color:inherit}.language-posh .highlight .err{color:inherit;background-color:inherit}</style></head><body><main role="main"><header role="banner"> <!--<h1 class="logo">Just a blog</h1>--><nav role="navigation"><ul><li><a href="/" >Writing</a></li><li><a href="/about" >About</a></li><li><a href="/search" >Search</a></li><li><a href="/atom.xml" >Rss</a></li></ul></nav><div class="networth"><dl><dt><u>Assets</u></dt><dd>- home <span class="amount">18.0k</span></dd><dd>- device(s) <span class="amount">1.0k</span></dd><dd>- stock(s) <span class="amount">2.0k</span></dd><dd>- server <span class="amount">0.1k</span></dd><dd>- cash <span class="amount">0.1k</span></dd><dt><u>Liabilities</u></dt><dd>- debt <span class="amount">4.0k</span></dd><dd>- loan <span class="amount">0.0k</span></dd></dl><div class="total"> <b><span>My Net: 17.2k</span></b> </br> <small>03-31-2021</small></div></div><script> const format = (x) => (x < 10) ? "0" + x : x; setInterval(() => { let delta = (new Date("2055/12/31") - new Date()) / 1000; const days = delta / 86400 | 0; document.getElementById('days').innerHTML = days; delta -= days * 86400; const hours = (delta / 3600 | 0) % 24; document.getElementById('hours').innerHTML = format(hours); delta -= hours * 3600; const minutes = (delta / 60 | 0) % 60; document.getElementById('mins').innerHTML = `:${format(minutes)}:`; delta -= minutes * 60; document.getElementById('secs').innerHTML = format((delta % 60) | 0); }, 1000); </script><div class="expiration"> <span class="right1">Expired by:</span></br> <span class="right1"> <span id="days"></span> <span id="hours"></span><span id="mins"></span><span id="secs"></span> </span></div></header><section class="post"><h2>RITSEC CTF 2021 notes</h2><blockquote><p>RITSEC CTF 2021 is a security-focused competition that features the following categories: Bin, OSINT, PWN, Crypto, Forensics, Steganography, and Web. We welcome beginners and more advanced security friends! There will be three brackets: RIT students, other college students, and everyone else.</p></blockquote><h3 id="1-snek-revbin">1. <a id="snek" style="text-decoration:none;">snek [rev/bin]</a></h3><p>The challenge statement:</p><blockquote><p>No step on snek<br /> Author: knif3<br /> File: <a href="/assets/img/ritsec/snek">snek</a></p></blockquote><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>file snek <span class="c"># what is it?</span>
</code></pre></div></div><div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>snek: python 3.7 byte-compiled
</code></pre></div></div><p>Google: “decompile python 3.7 byte compiled” =&gt; <a href="https://pypi.org/project/uncompyle6/">https://pypi.org/project/uncompyle6/</a></p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>uncompyle6 snek
</code></pre></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># file snek
# path snek must point to a Python source that can be compiled, or Python bytecode (.pyc, .pyo)
</code></pre></div></div><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">mv </span>snek snek.pyc <span class="o">&amp;&amp;</span> uncompyle6 snek.pyc <span class="c"># rename it and try again.</span>
</code></pre></div></div><div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># uncompyle6 ...
</span><span class="s">"""
Written for RITSEC CTF 2021
Author: knif3
Flag: RITSEC{}
TODO: Finish this challenge
"""</span>
<span class="k">class</span> <span class="nc">d</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">password</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">password</span> <span class="o">=</span> <span class="n">password</span><span class="p">.</span><span class="n">encode</span><span class="p">()</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">decrypt</span> <span class="o">=</span> <span class="p">[</span><span class="mi">97</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">106</span><span class="p">,</span> <span class="mi">107</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">109</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">113</span><span class="p">,</span> <span class="mi">114</span><span class="p">,</span> <span class="mi">115</span><span class="p">,</span> <span class="mi">116</span><span class="p">,</span> <span class="mi">117</span><span class="p">,</span> <span class="mi">118</span><span class="p">,</span> <span class="mi">119</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">122</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">86</span><span class="p">,</span> <span class="mi">87</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">123</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">116</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">125</span><span class="p">]</span>
    <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">password</span> <span class="o">==</span> <span class="nb">bytes</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">decrypt</span><span class="p">):</span>
            <span class="k">print</span><span class="p">(</span><span class="s">'!flag'</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">True</span>
        <span class="k">return</span> <span class="bp">False</span>
<span class="n">x</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">'Enter my name: '</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">d</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="k">if</span> <span class="n">a</span> <span class="o">==</span> <span class="n">x</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'IS_THIS_THE_FLAG??'</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'NOPE'</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'WRONG'</span><span class="p">)</span>
</code></pre></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ python3
</code></pre></div></div><div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="s">""</span><span class="p">.</span><span class="n">join</span><span class="p">([</span><span class="nb">chr</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">97</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">106</span><span class="p">,</span> <span class="mi">107</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">109</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">113</span><span class="p">,</span> <span class="mi">114</span><span class="p">,</span> <span class="mi">115</span><span class="p">,</span> <span class="mi">116</span><span class="p">,</span> <span class="mi">117</span><span class="p">,</span> <span class="mi">118</span><span class="p">,</span> <span class="mi">119</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">122</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">86</span><span class="p">,</span> <span class="mi">87</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">123</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">116</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">125</span><span class="p">]])</span>

<span class="s">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_RS{all_hi$$_and_n0_bit3}'</span>
</code></pre></div></div><h3 id="2-dababyweb-web">2. <a id="dababyweb" style="text-decoration:none;">DababyWeb [web]</a></h3><p>The challenge statement:</p><blockquote><p>Dababy wanted to share a message, but he seemed to put it too high up…<br /> 34.72.118.158:6284<br /> Author: Darkfowl</p></blockquote><p><img src="/assets/img/ritsec/dababy/index.png" alt="Landing page" /> <img src="/assets/img/ritsec/dababy/fun1.png" alt="Fun1 page" /> <img src="/assets/img/ritsec/dababy/test.png" alt="Testing" /> Google: “PHP local file inclusion cheat sheet” =&gt; <a href="https://highon.coffee/blog/lfi-cheat-sheet/">https://highon.coffee/blog/lfi-cheat-sheet/</a>. Am I feeling lucky? <code class="language-plaintext highlighter-rouge">file=./flag.txt</code> =&gt; no, <code class="language-plaintext highlighter-rouge">file=./../flag.txt</code>. =&gt; yes <code class="language-plaintext highlighter-rouge">RS{J3TS0N_M4D3_4N0TH3R_0N3}</code>. The proper solution seems to be published <a href="https://ctftime.org/writeup/27226">here</a>.</p><h3 id="3-robots-web">3. <a id="robots" style="text-decoration:none;">Robots [web]</a></h3><p>The challenge statement:</p><blockquote><p>Robots are taking over. Find out more.<br /> 34.69.61.54:5247<br /> Author: f1rehaz4rd</p></blockquote><p><img src="/assets/img/ritsec/robots/index.png" alt="Landing page" /> <img src="/assets/img/ritsec/robots/robots.png" alt="Robots.txt" /></p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">echo </span>UlN7UjBib3RzX2FyM19iNGR9 | <span class="nb">base64</span> <span class="nt">-d</span>
</code></pre></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>RS{R0bots_ar3_b4d}
</code></pre></div></div><h3 id="4-sessions-web">4. <a id="sessions" style="text-decoration:none;">Sessions [web]</a></h3><p>The challenge statement:</p><blockquote><p>Find the flag.<br /> http://34.69.61.54:4777<br /> Author: f1rehaz4rd</p></blockquote><p><img src="/assets/img/ritsec/sessions/index.png" alt="Landing page" /> <img src="/assets/img/ritsec/sessions/hint.png" alt="Login credential hint" /> <img src="/assets/img/ritsec/sessions/session.png" alt="Cookie" /></p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">echo </span><span class="nv">UlN7MG5seV9PbmVfczNzc2lvbl90b2szbn0</span><span class="o">=</span> | <span class="nb">base64</span> <span class="nt">-d</span>
</code></pre></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>RS{0nly_One_s3ssion_tok3n}
</code></pre></div></div><h3 id="5-1597-forensics">5. <a id="1597" style="text-decoration:none;">1597 [forensics]</a></h3><p>The challenge statement:</p><blockquote><p>… as in https://xkcd.com/1597/<br /> http://git.ritsec.club:7000/1597.git/<br /> Author: knif3</p></blockquote><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone http://git.ritsec.club:7000/1597.git/
</code></pre></div></div><p><img src="/assets/img/ritsec/1597/extensions.png" alt="Git extensions" /></p><h3 id="6-inception-ctf-dream-1-forensics">6. <a id="dream" style="text-decoration:none;">Inception CTF: Dream 1 [forensics]</a></h3><p>The challenge statement:</p><blockquote><p>The purpose of this CTF challenge is to identify common methods of hiding malicious files and code. In most cases adversaries will attempt<br /> to evade defenses in many cases by masquerading, hiding files, and more. There are five directories like the five levels in the movie<br /> Inception: Reality - Van Chase - The Hotel - Snow Fortress - Limbo. You will find one flag in each of the levels, that flag will also<br /> be the password to extract the next directory. Requirements: • You must have 7zip installed • Drop the InceptionCTF.7z on the Desktop as “InceptionCTF” • Use the option “Extract to “name of directory” for the CTF to function properly Missing either of the above may result<br /> in complications which may cause issues when attempting to find flags. NOTE: The flag format is <code class="language-plaintext highlighter-rouge">RITSEC{}</code></p></blockquote><blockquote><p>Dream 1: We have to get to their subconscious first, look for a hidden text file within the directory “Reality” this flag will unlock the next.</p></blockquote><blockquote><p>We would like to thank our sponsor @SRA for contributing this challenge!</p></blockquote><blockquote><p>File: <a href="/assets/img/ritsec/dream/InceptionCTFRITSEC.7z">InceptionCTFRITSEC.7z</a></p></blockquote><p><img src="/assets/img/ritsec/dream/reality.png" alt="Reality.7z" /></p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># reverse the string with python3</span>
<span class="nv">$ </span>python3 <span class="nt">-c</span> <span class="s1">'print("{dnalmaerD}CESTIR"[::-1])'</span>
</code></pre></div></div><div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>RITSEC}Dreamland{
</code></pre></div></div><div class="language-posh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># change directory</span><span class="w">
</span><span class="err">&gt;</span><span class="w"> </span><span class="n">cd</span><span class="w"> </span><span class="nx">Desktop\InceptionCTF</span><span class="w">

</span><span class="c"># make 7z runnable from cmd</span><span class="w">
</span><span class="err">&gt;</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="nx">PATH</span><span class="o">=%</span><span class="n">PATH</span><span class="o">%</span><span class="p">;</span><span class="n">C:\Program</span><span class="w"> </span><span class="nx">Files\7-Zip\</span><span class="w">

</span><span class="c"># extract `Reality.7z` to `Reality` folder</span><span class="w">
</span><span class="err">&gt;</span><span class="w"> </span><span class="mi">7</span><span class="n">z</span><span class="w"> </span><span class="nx">e</span><span class="w"> </span><span class="nx">Reality.7z</span><span class="w"> </span><span class="nt">-oReality</span><span class="w">
</span></code></pre></div></div><div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>7-Zip 19.00 (x64) : Copyright (c) 1999-2018 Igor Pavlov : 2019-02-21 ...
Extracting archive: Reality.7z, Everything is Ok, Files: 2 ...
</code></pre></div></div><div class="language-posh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># change dir to `Reality`</span><span class="w">
</span><span class="err">&gt;</span><span class="w"> </span><span class="n">cd</span><span class="w"> </span><span class="nx">Reality</span><span class="w">

</span><span class="c"># extract `VanChase.7z` to `VanChase` folder using `Dreamland` password.</span><span class="w">
</span><span class="err">&gt;</span><span class="w"> </span><span class="mi">7</span><span class="n">z</span><span class="w"> </span><span class="nx">e</span><span class="w"> </span><span class="nx">VanChase.7z</span><span class="w"> </span><span class="nt">-oVanChase</span><span class="w"> </span><span class="nt">-pDreamland</span><span class="w">
</span></code></pre></div></div><div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>7-Zip 19.00 (x64) : Copyright (c) 1999-2018 Igor Pavlov : 2019-02-21 ...
Extracting archive: VanChase.7z, Everything is Ok, Files: 3 ...
</code></pre></div></div><p><img src="/assets/img/ritsec/dream/vanchase.png" alt="VanChase.7z" /></p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>python3
</code></pre></div></div><div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="nb">bytes</span><span class="p">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s">'52 49 54 53 45 43 7b 57 61 74 65 72 55 6e 64 65 72 54 68 65 42 72 69 64 67 65 7d'</span><span class="p">).</span><span class="n">decode</span><span class="p">()</span>
</code></pre></div></div><div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>RITSEC{WaterUnderTheBridge}
</code></pre></div></div><div class="language-posh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># set the correct password for the `VanChase\Kick.ps1` script.</span><span class="w">
</span><span class="n">set-alias</span><span class="w"> </span><span class="nx">laylow</span><span class="w"> </span><span class="s2">"</span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">ProgramFiles</span><span class="s2">\7-Zip\7z.exe"</span><span class="w">
</span><span class="nv">$7zf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"TheHotel.7z"</span><span class="w">
</span><span class="nv">$7zp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"WaterUnderTheBridge"</span><span class="w"> </span><span class="c"># &lt;---- Enter Password inbetween the Double Qoutes</span><span class="w">
</span><span class="nv">$7zo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"-aoa"</span><span class="w">
</span><span class="n">laylow</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="nv">$7zf</span><span class="w"> </span><span class="s2">"-p</span><span class="nv">$7zp</span><span class="s2">"</span><span class="w"> </span><span class="nv">$7zo</span><span class="w">
</span><span class="n">Start-Sleep</span><span class="w"> </span><span class="nt">-s</span><span class="w"> </span><span class="nx">3</span><span class="w">
</span><span class="n">New-Item</span><span class="w"> </span><span class="nt">-Path</span><span class="w"> </span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">userprofile</span><span class="nx">\Desktop\InceptionCTF\Reality\VanChase\</span><span class="w"> </span><span class="nt">-Name</span><span class="w"> </span><span class="nx">TheHotel</span><span class="w"> </span><span class="nt">-ItemType</span><span class="w"> </span><span class="s2">"directory"</span><span class="w">
</span><span class="n">Start-Sleep</span><span class="w"> </span><span class="nt">-s</span><span class="w"> </span><span class="nx">3</span><span class="w">
</span><span class="n">Move-Item</span><span class="w"> </span><span class="nt">-Path</span><span class="w"> </span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">userprofile</span><span class="nx">\Desktop\InceptionCTF\Reality\VanChase\ThePointMan.txt</span><span class="w"> </span><span class="nt">-Destination</span><span class="w"> </span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">userprofile</span><span class="nx">\Desktop\InceptionCTF\Reality\VanChase\TheHotel\ThePointMan.txt</span><span class="w">
</span><span class="n">Move-Item</span><span class="w"> </span><span class="nt">-Path</span><span class="w"> </span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">userprofile</span><span class="nx">\Desktop\InceptionCTF\Reality\VanChase\</span><span class="err">‎</span><span class="w"> </span><span class="nt">-Destination</span><span class="w"> </span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">userprofile</span><span class="nx">\Desktop\InceptionCTF\Reality\VanChase\TheHotel\</span><span class="err">‎</span><span class="w">
</span><span class="n">Move-Item</span><span class="w"> </span><span class="nt">-Path</span><span class="w"> </span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">userprofile</span><span class="nx">\Desktop\InceptionCTF\Reality\VanChase\SnowFortress.7z</span><span class="w"> </span><span class="nt">-Destination</span><span class="w"> </span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">userprofile</span><span class="nx">\Desktop\InceptionCTF\Reality\VanChase\TheHotel\SnowFortress.7z</span><span class="w">
</span><span class="n">Start-Sleep</span><span class="w"> </span><span class="nt">-s</span><span class="w"> </span><span class="nx">3</span><span class="w">
</span><span class="n">cd</span><span class="w"> </span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">userprofile</span><span class="nx">\Desktop\InceptionCTF\Reality\VanChase\TheHotel\</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">cmd.exe</span><span class="w"> </span><span class="o">--%</span><span class="w"> </span><span class="nx">/c</span><span class="w"> </span><span class="nx">type</span><span class="w"> </span><span class="err">‎</span><span class="w"> </span><span class="err">&gt;</span><span class="w"> </span><span class="nx">ThePointMan.txt:</span><span class="err">‎</span><span class="w">
</span><span class="n">Remove-Item</span><span class="w"> </span><span class="nt">-Path</span><span class="w"> </span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">userprofile</span><span class="nx">\Desktop\InceptionCTF\Reality\VanChase\TheHotel\</span><span class="err">‎</span><span class="w">
</span></code></pre></div></div><div class="language-posh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># change dir to `Vanchase`</span><span class="w">
</span><span class="err">&gt;</span><span class="w"> </span><span class="n">cd</span><span class="w"> </span><span class="nx">VanChase</span><span class="w">

</span><span class="c"># run the `Kick.ps1` script</span><span class="w">
</span><span class="err">&gt;</span><span class="w"> </span><span class="n">powershell</span><span class="w"> </span><span class="nt">-executionpolicy</span><span class="w"> </span><span class="nx">bypass</span><span class="w"> </span><span class="nt">-File</span><span class="w"> </span><span class="o">.</span><span class="nx">\Kicks.ps1</span><span class="w">
</span></code></pre></div></div><div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>7-Zip 19.00 (x64) : Copyright (c) 1999-2018 Igor Pavlov : 2019-02-21 ...
Extracting archive: VanChase.7z, Everything is Ok, Files: 3 ...
</code></pre></div></div><p>The content of the <code class="language-plaintext highlighter-rouge">TheHotel\ThePointMan.txt</code></p><div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Q3JlYXRlIGEgbWF6ZSBpbiB0d28gbWludXRlcyB0aGF0IHRha2VzIG1lIG9uZSBtdW5pdGUgdG8gc29sdmUuIA==

59 6f 75 27 72 65 20 77 61 69 74 69 6e 67 20 66 6f 72 20 61 20 74 72 61 69 6e 2c 20 61 20 74 72 61 69 6e 20 74 68 61 74 20 77 69 6c 6c 20 74 61 6b 65 20 79 6f 75 20 66 61 72 20 61 77 61 79 2e 20 59 6f 75 20 6b 6e 6f 77 20 77 68 65 72 65 20 79 6f 75 20 68 6f 70 65 20 74 68 69 73 20 74 72 61 69 6e 20 77 69 6c 6c 20 74 61 6b 65 20 79 6f 75 2c 20 62 75 74 20 79 6f 75 20 63 61 6e 27 74 20 62 65 20 73 75 72 65 2e 20 62 75 74 20 69 74 20 64 6f 65 73 6e 27 74 20 6d 61 74 74 65 72 20 2d 20 62 65 63 61 75 73 65 20 77 65 27 6c 6c 20 62 65 20 74 6f 67 65 74 68 65 72 2e 20

|JP.HPVK.Q.G@.DCWDLA.QJ.AW@DH.GLBB@W	.aDWILKB. BXOR 25

Gung znal qernzf jvguva qernzf vf gbb hafgnoyr!

--. ..- .-.
..-. .-. .-. --.-
--. ..- -. --.
.--- .-.
-.-. -.-- -. .- --. .-. --.-
...- .-
--. ..- ...- ..-.
--.. -. .- .----. ..-.
--.. ...- .- --.-
--.. -. .-..
.--. ..- -. .- - .-.
.-. .. .-. . .-.. --. ..- ...- .- - .-.-.-

No place for a tourist in this job.
</code></pre></div></div><p>I tried to decode all of these, soon I realized there was no point in that. I think the author may or may not have trolled us.</p><p><img src="/assets/img/ritsec/dream/hotel.png" alt="TheHotel.7z" /></p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">echo </span><span class="nv">NTIgNDkgNTQgNTMgNDUgNDMgN2IgNDYgNDAgMjEgMjEgNjkgNmUgNjcgNDUgNmMgNjUgNzYgNDAgNzQgNmYgNzIgN2Q</span><span class="o">=</span> | <span class="nb">base64</span> <span class="nt">-d</span>
</code></pre></div></div><div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>52 49 54 53 45 43 7b 46 40 21 21 69 6e 67 45 6c 65 76 40 74 6f 72 7d
</code></pre></div></div><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>python3
</code></pre></div></div><div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="nb">bytes</span><span class="p">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s">'52 49 54 53 45 43 7b 46 40 21 21 69 6e 67 45 6c 65 76 40 74 6f 72 7d'</span><span class="p">).</span><span class="n">decode</span><span class="p">()</span>
</code></pre></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>RITSEC{F@!!ingElev@tor}
</code></pre></div></div><div class="language-posh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># change dir to `TheHotel` folder</span><span class="w">
</span><span class="err">&gt;</span><span class="w"> </span><span class="n">cd</span><span class="w"> </span><span class="nx">TheHotel</span><span class="w">

</span><span class="c"># extract `SnowFortress.7z` to `SnowFortress` folder using `F@!!ingElev@tor` password.</span><span class="w">
</span><span class="err">&gt;</span><span class="w"> </span><span class="mi">7</span><span class="n">z</span><span class="w"> </span><span class="nx">e</span><span class="w"> </span><span class="nx">SnowFortress.7z</span><span class="w"> </span><span class="nt">-oSnowFortress</span><span class="w"> </span><span class="nt">-pF</span><span class="err">@</span><span class="o">!!</span><span class="nx">ingElev</span><span class="err">@</span><span class="nx">tor</span><span class="w">
</span></code></pre></div></div><div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>7-Zip 19.00 (x64) : Copyright (c) 1999-2018 Igor Pavlov : 2019-02-21 ...
Extracting archive: VanChase.7z, Everything is Ok, Files: 2 ...
</code></pre></div></div><p><img src="/assets/img/ritsec/dream/snowfortress.png" alt="SnowFortress.7z" /></p><p>This app seems to display a lot of gibberish text mostly. But the bottom part of it has few interesting lines.</p><div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>...
Building Dreams....

-.. .-. . .- -- ... ..-. . . .-.. .-. . .- .-.. .-- .... . -. .-- . .----. .-. . .. -. - .... . -- .-.-.- 
.. - .----. ... --- -. .-.. -.-- .-- .... . -. .-- . .-- .- -.- . ..- .--. - .... .- - .-- . .-. . .- .-.. 
.. --.. . ... --- -- . - .... .. -. --. .-- .- ... .- -.-. - ..- .- .-.. .-.. -.-- ... - .-. .- -. --. . 
.-.-.- .-. .. - ... . -.-. -...- -.. .. ...- . .-. ... .. --- -. 
</code></pre></div></div><p><img src="/assets/img/ritsec/dream/morse.png" alt="Morse code decoded" /></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># change dir to `SnowFortress` folder
&gt; cd SnowFortress

# extract `Limbo.7z` to `Limbo` folder using `DIVERSION` password
&gt; 7z e Limbo.7z -oLimbo -pDIVERSION
</code></pre></div></div><p>The <code class="language-plaintext highlighter-rouge">Limbo</code> folder contained the final image <code class="language-plaintext highlighter-rouge">inception.jpg</code>.</p><p><img src="/assets/img/ritsec/dream/inception.jpg" alt="Inception" /></p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>strings <span class="nt">-n10</span> inception.jpg
</code></pre></div></div><div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>++-+-+++-+--+++-2+--77-+++-+-+---+-7+7-+7+++++7+++
6 UklUU0VDezUyODQ5MX0g
</code></pre></div></div><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">echo </span>UklUU0VDezUyODQ5MX0g | <span class="nb">base64</span> <span class="nt">-d</span>
</code></pre></div></div><div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>RITSEC{528491}
</code></pre></div></div><p>I submitted the <code class="language-plaintext highlighter-rouge">RITSEC{528491}</code> flag for the <code class="language-plaintext highlighter-rouge">Inception CTF: Dream 1</code> challenge about a dozen times. I thought it should be the correct one. Soon I realized that I have done the whole series.</p><ul><li>Inception CTF: Dream 1 [forensics] ~ <code class="language-plaintext highlighter-rouge">RITSEC}Dreamland{</code></li><li>Inception CTF: Dream 2 [forensics] ~ <code class="language-plaintext highlighter-rouge">RITSEC{WaterUnderTheBridge}</code></li><li>Inception CTF: Dream 3 [forensics] ~ <code class="language-plaintext highlighter-rouge">RITSEC{F@!!ingElev@tor}</code></li><li>Inception CTF: Dream 4 [stego] ~ <code class="language-plaintext highlighter-rouge">RITSEC=DIVERSION</code></li><li>Inception CTF: Dream 5 [stego] ~ <code class="language-plaintext highlighter-rouge">RITSEC{528491}</code></li></ul><h3 id="7-parcel-forensics">7. <a id="parcel" style="text-decoration:none;">Parcel [forensics]</a></h3><p>The challenge statement:</p><blockquote><p>That’s a lot of magick<br /> Author: knif3</p></blockquote><blockquote><p>File: <a href="/assets/img/ritsec/Parcel">Parcel</a></p></blockquote><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>file Parcel
</code></pre></div></div><div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Parcel: gzip compressed data, from Unix, original size modulo 2^32 759456
</code></pre></div></div><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">gzip</span> <span class="nt">-d</span> Parcel
</code></pre></div></div><div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gzip: Parcel: unknown suffix -- ignored
</code></pre></div></div><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">mv </span>Parcel Parcel.gz <span class="o">&amp;&amp;</span> <span class="nb">gzip</span> <span class="nt">-d</span> Parcel.gz
<span class="nv">$ </span>file Parcel
</code></pre></div></div><div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Parcel: multipart/mixed; boundary="===============6501672606206171874==", ASCII text, with very long lines
</code></pre></div></div><p><img src="/assets/img/ritsec/parcel.png" alt="Parcel content" /></p><p>The <code class="language-plaintext highlighter-rouge">Parcel</code> file contained lots of base64 encoded image strings. I converted around 18 or so images using an online <a href="https://codebeautify.org/base64-to-image-converter">base64 to image</a> service. The images in the <code class="language-plaintext highlighter-rouge">parcel</code> turned out to be a picture puzzle. And yet another one of my fine art piece demonstration:</p><p><img src="/assets/img/ritsec/puzzle.png" alt="Parcel puzzle" /></p><h3 id="8-revision-misc">8. <a id="revision" style="text-decoration:none;">Revision [misc]</a></h3><p>The challenge statement:</p><blockquote><p>They aren’t necessarily obvious but are helpful to know.<br /> http://git.ritsec.club:7000/Revision.git/<br /> Author: knif3</p></blockquote><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>git clone http://git.ritsec.club:7000/Revision.git/
</code></pre></div></div><p><img src="/assets/img/ritsec/revision/r.png" alt="R" /> <img src="/assets/img/ritsec/revision/s.png" alt="S" /></p><p>Well, we need to check the repo commit by commit for a while. That I can do :) <code class="language-plaintext highlighter-rouge">RS{I_h0p3_y0u_scr1pted_th0s3_git_c0ms}</code>. ~ Yeah, me too.</p><h3 id="9-blob-forensics">9. <a id="blob" style="text-decoration:none;">Blob [forensics]</a></h3><p>The challenge statement:</p><blockquote><p>Ha. Blob. Did you get the reference?<br /> http://git.ritsec.club:7000/blob.git/<br /> Author: knif3</p></blockquote><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>git clone http://git.ritsec.club:7000/blob.git/
</code></pre></div></div><p><img src="/assets/img/ritsec/blob.png" alt="blob repo" /> I found nothing useful from the git commit history.</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># change dir to `blob`</span>
<span class="nv">$ </span><span class="nb">cd </span>blob

<span class="c"># list git tags</span>
<span class="nv">$ </span>git tag <span class="nt">-l</span>

<span class="c"># let's see what is the `flag` tag.</span>
<span class="nv">$ </span>git show flag
</code></pre></div></div><div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>RS{refs_can_b3_secret_too}
</code></pre></div></div><h3 id="10-please-click-all-the-things-1-begineersritsechtml-forensics">10. <a id="things1" style="text-decoration:none;">Please Click All the Things 1: BegineersRITSEC.html [forensics]</a></h3><p>The challenge statement:</p><blockquote><p>Note: this challenge is the start of a series of challenges. The purpose of this CTF challenge is to bring real world phishing attachments to the challengers and attempt to find flags (previously executables or malicious domains) within the macros. This is often a process used in IR teams and becomes an extremely valuable skill. In this challenge we’ve brought to the table a malicious html file, GandCrab/Ursnif sample, and a IceID/Bokbot sample. We’ve rewritten the code to not contain malicious execution however system changes may still occur when executing, also some of the functionalities have been snipped and will likely not expose itself via dynamic analysis.</p></blockquote><blockquote><ul><li>Outlook helps, with proper licensing to access necessary features</li><li>Otherwise oledump or similar would also help but isn’t necessary</li><li>CyberChef is the ideal tool to use for decoding</li></ul></blockquote><blockquote><p>Part 1: Start with the HTML file and let’s move our way up, open and or inspect the HTML file provide in the message file. There is only one flag in this document.</p></blockquote><blockquote><p>This challenge is brought to you by SRA<br /> File: <a href="/assets/img/ritsec/Please_Click_All_The_Things.7z">Please_Click_All_The_Things.7z</a></p></blockquote><p>I was not able to download this file in my windows 10. The Microsoft Windows Defender immediately deletes my download. Congratz!</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># download the file into my ubuntu box</span>
<span class="nv">$ </span>wget <span class="nt">-o</span> check.7z https://mediocreone.com/assets/img/ritsec/Please_Click_All_The_Things.7z

<span class="c"># my box did not have the 7z</span>
<span class="nv">$ </span><span class="nb">sudo </span>apt-get <span class="nb">install </span>p7zip-full <span class="nt">-y</span>

<span class="c"># unzip via 7z to `check` folder</span>
<span class="nv">$ </span>7z x check.7z <span class="nt">-ocheck</span>

<span class="c"># check downloaded file</span>
<span class="nv">$ </span><span class="nb">cd </span>check <span class="o">&amp;&amp;</span> file Please<span class="se">\ </span>Click<span class="se">\ </span>all<span class="se">\ </span>the<span class="se">\ </span>Things.msg
</code></pre></div></div><div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Please Click all the Things.msg: CDFV2 Microsoft Outlook Message
</code></pre></div></div><p>Google: “python extract attachment from msg file” =&gt; <a href="https://pypi.org/project/extract-msg/">https://pypi.org/project/extract-msg/</a>.</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># rename `Please Click all the Things` to `things` for less annoyence</span>
<span class="nv">$ </span> <span class="nb">mv </span>Please<span class="se">\ </span>Click<span class="se">\ </span>all<span class="se">\ </span>the<span class="se">\ </span>Things.msg things.msg

<span class="c"># extract attachments and list folders</span>
<span class="nv">$ </span>python3 <span class="nt">-m</span> extract_msg things.msg <span class="o">&amp;&amp;</span> <span class="nb">ls</span>
</code></pre></div></div><div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>'2021-02-25_1658 Please Click all the Things'   things.msg
</code></pre></div></div><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># renaming the long folder name</span>
<span class="nv">$ </span><span class="nb">mv </span>2021-02-25_1658<span class="se">\ </span>Please<span class="se">\ </span>Click<span class="se">\ </span>all<span class="se">\ </span>the<span class="se">\ </span>Things/ things <span class="o">&amp;&amp;</span> <span class="nb">ls </span>things
</code></pre></div></div><div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>BeginnersRITSEC.html  GandCrab_Ursnif_RITSEC.docm  IceID_Bokbot_RITSEC.docm  message.txt
</code></pre></div></div><p>The content of the <code class="language-plaintext highlighter-rouge">things/message.txt</code></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>From:
To: CTF@challengers.com &lt;CTF@challengers.com&gt;
CC:
Subject: Please Click all the Things
Date: Thu, 25 Feb 2021 16:58:00 +0000
-----------------
Hey there Challengers,

I’ve attached some malware, please do click them and infect your machines (seriously), wipe your systems after the CTF.
On a less troll note, for those new to analysis start with the HTML, move to GandCrab, and then if you’re feeling smart try IceID/Bokbot.
If you feel the need to bang your head please take safety precautions, clear away breakables including computer screens and preferably choose a softer surface to avoid injuries.
Thanks for contributing to the botnet.

Sincerely,
CTF Challenge Creators
</code></pre></div></div><p>The content of the <code class="language-plaintext highlighter-rouge">things/BeginnersRITSEC.html</code></p><div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;script </span><span class="na">language=</span><span class="s">"javascript"</span><span class="nt">&gt;</span><span class="nb">document</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="nx">unescape</span><span class="p">(</span><span class="dl">'</span><span class="s1">3c%68%74%6d%6c%3e%0a%3c%62%6f%64%79%3e%0a%0a%3c%21%44%4f%43%54%59%50%45%20%68%74%6d%6c%3e%0a%3c%68%74%6d%6c%3e%0a%3c%68%65%61%64%3e%0a%20%20%20%20%3c%74%69%74%6c%65%3e%49%74%73%20%6a%75%73%74%20%61%6e%6f%74%68%65%72%20%66%72%69%65%6e%64%6c%79%20%66%69%6c%65%20%66%72%6f%6d%20%79%6f%75%27%72%65%20%6c%6f%63%61%6c%20%43%54%46%3c%2f%74%69%74%6c%65%3e%0a%20%20%20%20%3c%73%74%79%6c%65%20%74%79%70%65%3d%22%74%65%78%74%2f%63%73%73%22%3e%0a%20%20%20%20%20%20%20%20%68%74%6d%6c%20%7b%0a%20%20%20%20%20%20%20%20%20%20%20%20%68%65%69%67%68%74%3a%20%31%30%30%25%3b%0a%20%20%20%20%20%20%20%20%20%20%20%20%77%69%64%74%68%3a%20%31%30%30%25%3b%0a%20%20%20%20%20%20%20%20%7d%0a%0a%20%20%20%20%20%20%20%20%23%66%65%61%74%75%72%65%20%7b%0a%20%20%20%20%20%20%20%20%20%20%20%20%77%69%64%74%68%3a%20%39%38%30%70%78%3b%0a%20%20%20%20%20%20%20%20%20%20%20%20%6d%61%72%67%69%6e%3a%20%39%35%70%78%20%61%75%74%6f%20%30%20%61%75%74%6f%3b%0a%20%20%20%20%20%20%20%20%20%20%20%20%6f%76%65%72%66%6c%6f%77%3a%20%61%75%74%6f%3b%0a%20%20%20%20%20%20%20%20%7d%0a%0a%20%20%20%20%20%20%20%20%23%63%6f%6e%74%65%6e%74%20%7b%0a%20%20%20%20%20%20%20%20%20%20%20%20%66%6f%6e%74%2d%66%61%6d%69%6c%79%3a%20%22%53%65%67%6f%65%20%55%49%22%3b%0a%20%20%20%20%20%20%20%20%20%20%20%20%66%6f%6e%74%2d%77%65%69%67%68%74%3a%20%6e%6f%72%6d%61%6c%3b%0a%20%20%20%20%20%20%20%20%20%20%20%20%66%6f%6e%74%2d%73%69%7a%65%3a%20%32%32%70%78%3b%0a%20%20%20%20%20%20%20%20%20%20%20%20%63%6f%6c%6f%72%3a%20%23%66%66%66%66%66%66%3b%0a%20%20%20%20%20%20%20%20%20%20%20%20%66%6c%6f%61%74%3a%20%6c%65%66%74%3b%0a%20%20%20%20%20%20%20%20%20%20%20%20%77%69%64%74%68%3a%20%34%36%30%70%78%3b%0a%20%20%20%20%20%20%20%20%20%20%20%20%6d%61%72%67%69%6e%2d%74%6f%70%3a%20%36%38%70%78%3b%0a%20%20%20%20%20%20%20%20%20%20%20%20%6d%61%72%67%69%6e%2d%6c%65%66%74%3a%20%30%70%78%3b%0a%20%20%20%20%20%20%20%20%20%20%20%20%76%65%72%74%69%63%61%6c%2d%61%6c%69%67%6e%3a%20%6d%69%64%64%6c%65%3b%0a%20%20%20%20%20%20%20%20%7d%0a%0a%20%20%20%20%20%20%20%20%20%20%20%20%23%63%6f%6e%74%65%6e%74%20%68%31%20%7b%0a%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%66%6f%6e%74%2d%66%61%6d%69%6c%79%3a%20%22%53%65%67%6f%65%20%55%49%20%4c%69%67%68%74%22%3b%0a%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%63%6f%6c%6f%72%3a%20%23%66%66%66%66%66%66%3b%0a%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%66%6f%6e%74%2d%77%65%69%67%68%74%3a%20%6e%6f%72%6d%61%6c%3b%0a%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%66%6f%6e%74%2d%73%69%7a%65%3a%20%36%30%70%78%3b%0a%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%6c%69%6e%65%2d%68%65%69%67%68%74%3a%20%34%38%70%74%3b%0a%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%77%69%64%74%68%3a%20%39%38%30%70%78%3b%0a%20%20%20%20%20%20%20%20%20%20%20%20%7d%0a%0a%20%20%20%20%20%20%20%20%70%20%61%2c%20%70%20%61%3a%76%69%73%69%74%65%64%2c%20%70%20%61%3a%61%63%74%69%76%65%2c%20%70%20%61%3a%68%6f%76%65%72%20%7b%0a%20%20%20%20%20%20%20%20%20%20%20%20%63%6f%6c%6f%72%3a%20%23%66%66%66%66%66%66%3b%0a%20%20%20%20%20%20%20%20%7d%0a%0a%20%20%20%20%20%20%20%20%23%63%6f%6e%74%65%6e%74%20%61%2e%62%75%74%74%6f%6e%20%7b%0a%20%20%20%20%20%20%20%20%20%20%20%20%62%61%63%6b%67%72%6f%75%6e%64%3a%20%23%30%44%42%43%46%32%3b%0a%20%20%20%20%20%20%20%20%20%20%20%20%62%6f%72%64%65%72%3a%20%31%70%78%20%73%6f%6c%69%64%20%23%46%46%46%46%46%46%3b%0a%20%20%20%20%20%20%20%20%20%20%20%20%63%6f%6c%6f%72%3a%20%23%46%46%46%46%46%46%3b%0a%20%20%20%20%20%20%20%20%20%20%20%20%64%69%73%70%6c%61%79%3a%20%69%6e%6c%69%6e%65%2d%62%6c%6f%63%6b%3b%0a%20%20%20%20%20%20%20%20%20%20%20%20%66%6f%6e%74%2d%66%61%6d%69%6c%79%3a%20%53%65%67%6f%65%20%55%49%3b%0a%20%20%20%20%20%20%20%20%20%20%20%20%66%6f%6e%74%2d%73%69%7a%65%3a%20%32%34%70%78%3b%0a%20%20%20%20%20%20%20%20%20%20%20%20%6c%69%6e%65%2d%68%65%69%67%68%74%3a%20%34%36%70%78%3b%0a%20%20%20%20%20%20%20%20%20%20%20%20%6d%61%72%67%69%6e%2d%74%6f%70%3a%20%31%30%70%78%3b%0a%20%20%20%20%20%20%20%20%20%20%20%20%70%61%64%64%69%6e%67%3a%20%30%20%31%35%70%78%20%33%70%78%3b%0a%20%20%20%20%20%20%20%20%20%20%20%20%74%65%78%74%2d%64%65%63%6f%72%61%74%69%6f%6e%3a%20%6e%6f%6e%65%3b%0a%20%20%20%20%20%20%20%20%7d%0a%0a%20%20%20%20%20%20%20%20%20%20%20%20%23%63%6f%6e%74%65%6e%74%20%61%2e%62%75%74%74%6f%6e%20%69%6d%67%20%7b%0a%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%66%6c%6f%61%74%3a%20%72%69%67%68%74%3b%0a%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%70%61%64%64%69%6e%67%3a%20%31%30%70%78%20%30%20%30%20%31%35%70%78%3b%0a%20%20%20%20%20%20%20%20%20%20%20%20%7d%0a%0a%20%20%20%20%20%20%20%20%20%20%20%20%23%63%6f%6e%74%65%6e%74%20%61%2e%62%75%74%74%6f%6e%3a%68%6f%76%65%72%20%7b%0a%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%62%61%63%6b%67%72%6f%75%6e%64%3a%20%23%31%43%37%35%42%43%3b%0a%20%20%20%20%20%20%20%20%20%20%20%20%7d%0a%0a%2f%2a%20%6c%6f%61%64%69%6e%67%20%64%6f%74%73%20%2a%2f%0a%0a%2e%6c%6f%61%64%69%6e%67%3a%61%66%74%65%72%20%7b%0a%20%20%63%6f%6e%74%65%6e%74%3a%20%27%2e%27%3b%0a%20%20%61%6e%69%6d%61%74%69%6f%6e%3a%20%64%6f%74%73%20%31%73%20%73%74%65%70%73%28%35%2c%20%65%6e%64%29%20%69%6e%66%69%6e%69%74%65%7d%0a%0a%40%6b%65%79%66%72%61%6d%65%73%20%64%6f%74%73%20%7b%0a%20%20%30%25%2c%20%32%30%25%20%7b%0a%20%20%20%20%63%6f%6c%6f%72%3a%20%72%67%62%61%28%30%2c%30%2c%30%2c%30%29%3b%0a%20%20%20%20%74%65%78%74%2d%73%68%61%64%6f%77%3a%0a%20%20%20%20%20%20%2e%32%35%65%6d%20%30%20%30%20%72%67%62%61%28%30%2c%30%2c%30%2c%30%29%2c%0a%20%20%20%20%20%20%2e%35%65%6d%20%30%20%30%20%72%67%62%61%28%30%2c%30%2c%30%2c%30%29%3b%7d%0a%20%20%34%30%25%20%7b%0a%20%20%20%20%63%6f%6c%6f%72%3a%20%77%68%69%74%65%3b%0a%20%20%20%20%74%65%78%74%2d%73%68%61%64%6f%77%3a%0a%20%20%20%20%20%20%2e%32%35%65%6d%20%30%20%30%20%72%67%62%61%28%30%2c%30%2c%30%2c%30%29%2c%0a%20%20%20%20%20%20%2e%35%65%6d%20%30%20%30%20%72%67%62%61%28%30%2c%30%2c%30%2c%30%29%3b%7d%0a%20%20%36%30%25%20%7b%0a%20%20%20%20%74%65%78%74%2d%73%68%61%64%6f%77%3a%0a%20%20%20%20%20%20%2e%32%35%65%6d%20%30%20%30%20%77%68%69%74%65%2c%0a%20%20%20%20%20%20%2e%35%65%6d%20%30%20%30%20%72%67%62%61%28%30%2c%30%2c%30%2c%30%29%3b%7d%0a%20%20%38%30%25%2c%20%31%30%30%25%20%7b%0a%20%20%20%20%74%65%78%74%2d%73%68%61%64%6f%77%3a%0a%20%20%20%20%20%20%2e%32%35%65%6d%20%30%20%30%20%77%68%69%74%65%2c%0a%20%20%20%20%20%20%2e%35%65%6d%20%30%20%30%20%77%68%69%74%65%3b%7d%7d%0a%20%20%20%20%3c%2f%73%74%79%6c%65%3e%0a%3c%2f%68%65%61%64%3e%0a%3c%62%6f%64%79%20%62%67%63%6f%6c%6f%72%3d%22%23%30%30%61%62%65%63%22%3e%0a%20%20%20%20%3c%64%69%76%20%69%64%3d%22%66%65%61%74%75%72%65%22%3e%0a%20%20%20%20%20%20%20%20%20%20%20%20%3c%64%69%76%20%69%64%3d%22%63%6f%6e%74%65%6e%74%22%3e%0a%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3c%68%31%20%69%64%3d%22%75%6e%61%76%61%69%6c%61%62%6c%65%22%20%63%6c%61%73%73%3d%22%6c%6f%61%64%69%6e%67%22%3e%54%72%79%20%48%61%72%64%65%72%3c%2f%68%31%3e%0a%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3c%70%20%69%64%3d%22%74%72%79%41%67%61%69%6e%22%20%63%6c%61%73%73%3d%22%6c%6f%61%64%69%6e%67%22%3e%54%68%65%20%44%65%66%65%6e%64%65%72%20%54%68%61%74%20%43%6f%75%6c%64%3c%2f%70%3e%0a%20%20%20%20%20%20%20%20%3c%2f%64%69%76%3e%0a%20%20%20%20%3c%2f%64%69%76%3e%0a%3c%2f%62%6f%64%79%3e%0a%0a%0a%20%20%3c%68%65%61%64%3e%20%0a%3c%66%6c%61%67%3d%22%55%6b%6c%55%55%30%56%44%65%30%67%7a%63%6a%4d%68%64%43%45%6b%66%51%3d%3d%22%3e%0a%3c%2f%62%6f%64%79%3e%0a%20%20%3c%2f%68%74%6d%6c%3e</span><span class="dl">'</span><span class="p">));</span><span class="nt">&lt;/script&gt;</span>
</code></pre></div></div><p>The content after decoding it with an online <a href="https://codebeautify.org/url-decode-string">URL decoding</a> service.</p><div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>3chtml&gt;
<span class="nt">&lt;body&gt;</span>
<span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>

<span class="nt">&lt;head&gt;</span>
  <span class="nt">&lt;title&gt;</span>Its just another friendly file from you're local CTF<span class="nt">&lt;/title&gt;</span>
  <span class="nt">&lt;style </span><span class="na">type=</span><span class="s">"text/css"</span><span class="nt">&gt;</span>
    <span class="c">/* MediocreOne note: deleted CSS rules to make life easier */</span>
  <span class="nt">&lt;/style&gt;</span>
<span class="nt">&lt;/head&gt;</span>

<span class="nt">&lt;body</span> <span class="na">bgcolor=</span><span class="s">"#00abec"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"feature"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"content"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;h1</span> <span class="na">id=</span><span class="s">"unavailable"</span> <span class="na">class=</span><span class="s">"loading"</span><span class="nt">&gt;</span>Try Harder<span class="nt">&lt;/h1&gt;</span>
      <span class="nt">&lt;p</span> <span class="na">id=</span><span class="s">"tryAgain"</span> <span class="na">class=</span><span class="s">"loading"</span><span class="nt">&gt;</span>The Defender That Could<span class="nt">&lt;/p&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/body&gt;</span>

<span class="nt">&lt;head&gt;</span>
  <span class="nt">&lt;flag</span><span class="err">="</span><span class="na">UklUU0VDe0gzcjMhdCEkfQ=</span><span class="s">="</span><span class="nt">&gt;</span>
    <span class="nt">&lt;/body&gt;</span>

<span class="nt">&lt;/html&gt;</span>
</code></pre></div></div><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo </span><span class="nv">UklUU0VDe0gzcjMhdCEkfQ</span><span class="o">==</span> | <span class="nb">base64</span> <span class="nt">-d</span>
</code></pre></div></div><div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>RITSEC{H3r3!t!$}
</code></pre></div></div><h3 id="11-please-click-all-the-things-2-gandcrab_ursnifhtml-forensics">11. <a id="things2" style="text-decoration:none;">Please Click All the Things 2: GandCrab_Ursnif.html [forensics]</a></h3><p>The challenge statement:</p><blockquote><p>GandCrab/Ursnif are dangerous types of campaigns and malware, macros are usually the entry point,<br /> see what you can find, there are two flags in this document. Flag1/2</p></blockquote><blockquote><p>Author: Brandon Martin</p></blockquote><ul><li>Google: “python extract macros from dotm” =&gt; <a href="https://blog.didierstevens.com/programs/oledump-py/">https://blog.didierstevens.com/programs/oledump-py/</a></li><li>Google: “Github oledump” =&gt; <a href="https://github.com/DidierStevens/DidierStevensSuite/blob/master/oledump.py">https://github.com/DidierStevens/DidierStevensSuite/blob/master/oledump.py</a></li></ul><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># change dir to `things` folder</span>
<span class="nv">$ </span><span class="nb">cd </span>things

<span class="c"># download the `oledump.py`</span>
wget https://raw.githubusercontent.com/DidierStevens/DidierStevensSuite/master/oledump.py

<span class="c"># analyze the `GandCrab_Ursnif_RITSEC.docm` file</span>
<span class="nv">$ </span>python3 oledump.py GandCrab_Ursnif_RITSEC.docm
</code></pre></div></div><div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>A: word/vbaProject.bin
 A1:       464 'PROJECT'
 A2:        89 'PROJECTwm'
 A3: M     975 'VBA/Module1'
 A4: M    1504 'VBA/Module4'
 A5: m     938 'VBA/ThisDocument'
 A6:      3109 'VBA/_VBA_PROJECT'
 A7:       585 'VBA/dir'
</code></pre></div></div><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># dump macro at A3</span>
<span class="nv">$ </span>python3 oledump.py <span class="nt">-s</span> A3 <span class="nt">-v</span> GandCrab_Ursnif_RITSEC.docm
</code></pre></div></div><div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Attribute</span> <span class="n">VB_Name</span> <span class="o">=</span> <span class="s">"Module1"</span>
<span class="k">Sub</span> <span class="nf">autoopen</span><span class="p">()</span>
<span class="n">TheDarkSide</span>
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div></div><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># dump macro at A4</span>
<span class="nv">$ </span>python3 oledump.py <span class="nt">-s</span> A4 <span class="nt">-v</span> GandCrab_Ursnif_RITSEC.docm
</code></pre></div></div><div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Attribute</span> <span class="n">VB_Name</span> <span class="o">=</span> <span class="s">"Module4"</span>
<span class="k">Function</span> <span class="nf">TheDarkSide</span><span class="p">()</span>
<span class="k">On</span> <span class="k">Error</span> <span class="k">Resume</span> <span class="k">Next</span>
<span class="n">CTF</span> <span class="o">=</span> <span class="n">Array</span><span class="p">(</span><span class="n">ElonMusk</span><span class="p">,</span> <span class="n">StarWars</span><span class="p">,</span> <span class="n">HelloWorld</span><span class="p">,</span> <span class="n">Interaction</span><span class="p">.</span><span class="n">Shell</span><span class="p">(</span><span class="n">CleanString</span><span class="p">(</span><span class="n">Chewbacca</span><span class="p">.</span><span class="n">TextBox1</span><span class="p">),</span> <span class="mi">43</span> <span class="o">-</span> <span class="mi">43</span><span class="p">),</span> <span class="n">Mars</span><span class="p">)</span>
  <span class="k">Select</span> <span class="k">Case</span> <span class="n">Research</span>
  <span class="k">Case</span> <span class="mi">235003991</span>
    <span class="n">CompetitorSkillz</span> <span class="o">=</span> <span class="n">That_of_a_Storm_Troopers_Aim_Research_Pending</span>
    <span class="n">Flag</span> <span class="o">=</span> <span class="n">RITSEC</span><span class="p">{</span><span class="n">M</span><span class="err">@</span><span class="n">CROS</span><span class="p">}</span>
    <span class="n">PendingResearch</span> <span class="o">=</span> <span class="n">Oct</span><span class="p">(</span><span class="kt">Date</span> <span class="o">+</span> <span class="k">CStr</span><span class="p">(</span><span class="n">TimeStamp</span> <span class="o">+</span> <span class="n">Log</span><span class="p">(</span><span class="mi">241371097</span><span class="p">)</span> <span class="o">-</span> <span class="n">PewPew</span> <span class="o">/</span> <span class="n">Hex</span><span class="p">(</span><span class="mi">13775121</span><span class="p">)))</span>
  <span class="k">End</span> <span class="k">Select</span>
<span class="k">End</span> <span class="k">Function</span>
</code></pre></div></div><p>At least we seem to land on our first flag <code class="language-plaintext highlighter-rouge">RITSEC{M@CROS}</code>.</p><h3 id="12-please-click-all-the-things-3-iceid-forensics">12. <a id="things3" style="text-decoration:none;">Please Click All the Things 3: IceID [forensics]</a></h3><p>The challenge statement:</p><blockquote><p>Stepping it up to IceID/Bokbot, this challenge is like the previous challenge but requires some ability to read and understand coding in addition to some additional decoding skills, there are two flags in this document. (Flag 1/2)<br /> Author: Brandon Martin</p></blockquote><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># analyze the `IceID_Bokbot_RITSEC.docm` file</span>
<span class="nv">$ </span>python3 oledump.py IceID_Bokbot_RITSEC.docm
</code></pre></div></div><div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>A: word/vbaProject.bin
 A1:       631 'PROJECT'
 A2:       149 'PROJECTwm'
 A3:        97 'UserForm1/\x01CompObj'
 A4:       292 'UserForm1/\x03VBFrame'
 A5:        90 'UserForm1/f'
 A6:        72 'UserForm1/o'
 A7: M    3460 'VBA/Module1'
 A8: M    1159 'VBA/Module2'
 A9: M    1622 'VBA/NewMacros'
A10: m     938 'VBA/ThisDocument'
A11: M    1571 'VBA/UserForm1'
A12:      4182 'VBA/_VBA_PROJECT'
A13:       926 'VBA/dir'
</code></pre></div></div><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># dump macro at A7</span>
<span class="nv">$ </span>python3 oledump.py <span class="nt">-s</span> A7 <span class="nt">-v</span> IceID_Bokbot_RITSEC.docm
</code></pre></div></div><div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Attribute</span> <span class="n">VB_Name</span> <span class="o">=</span> <span class="s">"Module1"</span>
<span class="k">Public</span> <span class="k">Const</span> <span class="nv">aHVWt</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">"p_:_\_j_v_a_q_b_j_f_\_f_l_f_g_r_z_3_2_\_z_f_u_g_n__r_k_r_"</span>
<span class="k">Public</span> <span class="k">Const</span> <span class="nv">aqv6tf</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">"EVGFRP{E0GG1ATZ@YP0Q3}"</span>

<span class="k">Public</span> <span class="k">Const</span> <span class="nv">a7sVN</span> <span class="ow">As</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">"_"</span>
<span class="k">Public</span> <span class="k">Const</span> <span class="nv">asXlUN</span> <span class="ow">As</span> <span class="kt">Integer</span> <span class="o">=</span> <span class="o">-</span><span class="mi">954</span> <span class="o">+</span> <span class="mi">967</span>
<span class="k">Public</span> <span class="k">Function</span> <span class="nf">aENoBO</span><span class="p">(</span><span class="n">aHu95</span><span class="p">,</span> <span class="n">avuEG8</span><span class="p">)</span>
<span class="n">FileNumber</span> <span class="o">=</span> <span class="n">FreeFile</span>
<span class="n">Open</span> <span class="n">aHu95</span> <span class="k">For</span> <span class="n">Output</span> <span class="ow">As</span> <span class="p">#</span><span class="n">FileNumber</span>
<span class="n">Print</span> <span class="p">#</span><span class="n">FileNumber</span><span class="p">,</span> <span class="n">Spc</span><span class="p">(</span><span class="o">-</span><span class="mi">413</span> <span class="o">+</span> <span class="mi">456</span><span class="p">)</span>
<span class="n">Print</span> <span class="p">#</span><span class="n">FileNumber</span><span class="p">,</span> <span class="n">avuEG8</span>
<span class="n">Print</span> <span class="p">#</span><span class="n">FileNumber</span><span class="p">,</span> <span class="n">Spc</span><span class="p">(</span><span class="o">-</span><span class="mi">413</span> <span class="o">+</span> <span class="mi">456</span><span class="p">)</span>
<span class="n">Close</span> <span class="p">#</span><span class="n">FileNumber</span>
<span class="k">End</span> <span class="k">Function</span>
<span class="k">Sub</span> <span class="nf">aUoaN</span><span class="p">(</span><span class="n">adDgz</span><span class="p">,</span> <span class="n">at09Aq</span><span class="p">)</span>
<span class="n">FileCopy</span> <span class="n">adDgz</span><span class="p">,</span> <span class="n">at09Aq</span>
<span class="k">End</span> <span class="k">Sub</span>
<span class="k">Function</span> <span class="nf">anPr56</span><span class="p">(</span><span class="n">aCl8i</span><span class="p">)</span>
<span class="n">anPr56</span> <span class="o">=</span> <span class="n">Len</span><span class="p">(</span><span class="n">aCl8i</span><span class="p">)</span>
<span class="k">End</span> <span class="k">Function</span>
<span class="k">Function</span> <span class="nf">a79yA</span><span class="p">(</span><span class="n">aO0h5k</span><span class="p">)</span>
<span class="n">a79yA</span> <span class="o">=</span> <span class="n">aO0h5k</span> <span class="o">+</span> <span class="mi">12324</span> <span class="o">/</span> <span class="mi">474</span>
<span class="k">End</span> <span class="k">Function</span>
<span class="k">Function</span> <span class="nf">aHScDO</span><span class="p">(</span><span class="n">aoza8</span><span class="p">)</span> <span class="ow">As</span> <span class="kt">String</span>
<span class="k">Dim</span> <span class="nv">alc6yS</span> <span class="ow">As</span> <span class="kt">Long</span>
<span class="k">Dim</span> <span class="nv">a9uRX</span> <span class="ow">As</span> <span class="kt">Integer</span>
<span class="k">Dim</span> <span class="nv">agyvb</span> <span class="ow">As</span> <span class="kt">Integer</span>
<span class="k">For</span> <span class="n">alc6yS</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">To</span> <span class="n">anPr56</span><span class="p">(</span><span class="n">aoza8</span><span class="p">)</span>
<span class="n">agyvb</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">aFxdHY</span> <span class="o">=</span> <span class="n">VBA</span><span class="p">.</span><span class="n">Mid</span><span class="err">$</span><span class="p">(</span><span class="n">aoza8</span><span class="p">,</span> <span class="n">alc6yS</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">a9uRX</span> <span class="o">=</span> <span class="n">Asc</span><span class="p">(</span><span class="n">aFxdHY</span><span class="p">)</span>
<span class="k">If</span> <span class="p">(</span><span class="n">a9uRX</span> <span class="o">&gt;</span> <span class="mi">64</span> <span class="ow">And</span> <span class="n">a9uRX</span> <span class="o">&lt;</span> <span class="mi">91</span><span class="p">)</span> <span class="ow">Or</span> <span class="p">(</span><span class="n">a9uRX</span> <span class="o">&gt;</span> <span class="mi">96</span> <span class="ow">And</span> <span class="n">a9uRX</span> <span class="o">&lt;</span> <span class="mi">123</span><span class="p">)</span> <span class="k">Then</span>
<span class="n">agyvb</span> <span class="o">=</span> <span class="n">asXlUN</span>
<span class="n">a9uRX</span> <span class="o">=</span> <span class="n">a9uRX</span> <span class="o">-</span> <span class="n">agyvb</span>
<span class="k">If</span> <span class="n">a9uRX</span> <span class="o">&lt;</span> <span class="mi">97</span> <span class="ow">And</span> <span class="n">a9uRX</span> <span class="o">&gt;</span> <span class="mi">83</span> <span class="k">Then</span>
<span class="n">a9uRX</span> <span class="o">=</span> <span class="n">a79yA</span><span class="p">(</span><span class="n">a9uRX</span><span class="p">)</span>
<span class="k">ElseIf</span> <span class="n">a9uRX</span> <span class="o">&lt;</span> <span class="mi">65</span> <span class="k">Then</span>
<span class="n">a9uRX</span> <span class="o">=</span> <span class="n">a79yA</span><span class="p">(</span><span class="n">a9uRX</span><span class="p">)</span>
<span class="k">End</span> <span class="k">If</span>
<span class="k">End</span> <span class="k">If</span>
<span class="n">Mid</span><span class="err">$</span><span class="p">(</span><span class="n">aoza8</span><span class="p">,</span> <span class="n">alc6yS</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">VBA</span><span class="p">.</span><span class="n">Chr</span><span class="err">$</span><span class="p">(</span><span class="n">a9uRX</span><span class="p">)</span>
<span class="k">Next</span>
<span class="n">aHScDO</span> <span class="o">=</span> <span class="n">aoza8</span>
<span class="k">End</span> <span class="k">Function</span>
</code></pre></div></div><p>From here, the string <code class="language-plaintext highlighter-rouge">EVGFRP{E0GG1ATZ@YP0Q3}</code> looked awfully like a flag. I tried a couple of websites and eventually found the correct one.</p><p><img src="/assets/img/ritsec/rot13.png" alt="Rot13 decode" /></p><hr /><p>     </p><p>Well, there were a lot of cool challenges in this CTF. Those that I spent the most time and did not manage to solve taught me a lot. Thanks to those who organized the event.</p><span class="meta"><time datetime="2021-04-12T00:00:00+00:00">April 12, 2021</time> &middot; <a href="/tag/CTF">CTF</a>, <a href="/tag/decompile python bytecode">decompile python bytecode</a>, <a href="/tag/PHP LFI">PHP LFI</a>, <a href="/tag/forensics">forensics</a>, <a href="/tag/dotm macro extraction">dotm macro extraction</a>, <a href="/tag/git challenges">git challenges</a></span></section></main></body></html>
